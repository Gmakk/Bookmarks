как добавлять закладки, вручную через ворд или программно
В ИНТСРУМЕНТЕ УКАЗЫВАТЬ ИМЯ ЗАКЛАДКИ, ВЫЧИСЛЕНИЕ ФОРМУЛЫ(ВОЗМОЖНО ПУТЬ К ФАЙЛУ), К ЗАКЛАДКЕ С НУЖНЫМ ИМЕНЕМ ДОБАВИТСЯ run С ТЕГОМ <w:vanish />

ПРОХОДИТСЯ ПО ДОКУМЕНТЫ, РАСШИФРОВЫВАЕТ КАЖДУЮ ЗАКЛАДКУ И ДЕЛАЕТ ЗАПРОС В БД С ПОДСЛЕУЮЩЕЙ ПОДСТАНОВКОЙ

w:bookmarkStart всегда находится в параграфе, если параграфов несколько, то подставляется в первый, содержащий начало

Если вставка посреди параграфа и не выбрано сохранять стилизацию, то делить старый на несколько(2 по бокам или один с одногго из краев) и на новый посередине с новым форматированием

I went with the bookmark way, but coding with some kind of binding is probably alot smoother, though I think it's only supported in word 2007 (but don't quote me on this)
https://www.docx4java.org/forums/docx-java-f6/bookmarks-and-templates-advice-t681.html

Проблема в том, что поднимается на уровень выше и начало и конец закладки должны быть дочерними одного элемента



В формулах должна содержаться информация о:
	последовательности вывода данных из полей базы:
		база данных, таблица, поле

	форматирование:
		заголовок/нет, 

	стилизация:
		курсив, полужирный, желтые выделения, цвет текста

	шрифты, размеры:
		название шрифта, размер
		
	переносы:
		Отступы, форматирование абзаца
	и т.д.


Ограничения закладок:
-длина от 1 до 40 символов
-состоит из символов юникода, цифр, подчеркиваний
-не начинается с цифры
-не содержит пробелов и знаков препинания

скрытая закладка начинается с подчеркивания
		
Имена в PostgreSQL должны начинаться с буквы (a-z) или подчеркивания (_).
Последующими символами в имени могут быть буквы, цифры (0-9) или символы подчеркивания.
Имена, содержащие другие символы, можно заключить в двойные кавычки (“). Например, имена таблиц или столбцов могут содержать другие запрещенные символы, такие как пробелы, амперсанды (&) и т.д., Мы можем использовать эти символы, если они заключены в кавычки.


С какой базой данных работать, или не принципиально. Сделать мб свою тестовую.

Возможно сделать мини-приложение формочку-калькулятор выражений?

Нужно ли работать с закладками, которые помечают несколько параграфов, или они нужны только для обозначения места

Предполагается ли работа с невидимыми строками в документе, потому что я ищу именно их



Здравствуйте, хотел задать пару вопросов по проекту и уточнить правильно ли я делаю

Пока общая концепция выглядит так:
В документе есть ряд закладок. В графическом интерфейсе пользователь выбирает закладку по имени.
Выбирает оставить старую стилизацию/задает параметры новой для подставляемого текста. В том числе задается откуда из базы данных будет подставляться значение(таблица, поле, ключ)
По нажатию кнопки текст указанных закладок заменяется на значения из бд с нужной стилизацией.

На данный момент готово:
Составление формулы, парсинг формулы. Добавление невидимого элемента с формулой к закладке, чтение этого элемента.
Подстановка текста с нужными параметрами стилизации(пока несколько параметров не готовы) к закладке с нужным именем.

Есть еще несколько вопросов:
Некоторые элементы стилизации, например применение стиля заголовка описываются для всего параграфа, к которому относится закладка. Менять стиль всего параграфа или бить его на несколько?
Закладка нужна только чтобы пометить место подстановки(пустая закладка) или предполагается замещение старого текста закладки?
Есть ли какая-то бд из которой нужно брать значения или для примера свою тестовую заполнить?
Предполагается ли работа с невидимыми строками в документе, кроме как для хранения формул? Потому что формула пока хранится именно в них и если что будет видна вместе с остальными невидимыми элементами.



Закрывается ли connection при сборке мусора